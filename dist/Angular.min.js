/*! Angular 20-04-2016 */
var financeApp=angular.module("financeApp",["ui.router","ui.bootstrap"]);financeApp.config(function(a){a.state("finance",{url:"/finance",views:{"":{templateUrl:"partials/finance.html"},"yahoo@finance":{templateUrl:"partials/yahoo.html",controller:"yahooController"}}}).state("finance.lists",{url:"/lists",templateUrl:"partials/finance-list.html",controller:function(a){a.fin=[{name:"AAPL"},{name:"MSFT",id:2},{name:"GE",id:3}]}}).state("finance.detail",{url:"/detail/:name",templateUrl:"partials/finance-details.html",controller:function(a,b,c){a.name=b.name,a.date=new Date,a.marketResults={},new Markit.QuoteService(a.name,function(a){console.log(a),this.success(a)}),Markit.QuoteService.prototype.success=function(b){a.marketResults=b},c(function(){console.log(a.marketResults)},2e3)}})}),financeApp.controller("yahooController",function(a,b){a.symbol="GOOG",a.items=[],a.startDate="2012-12-05",a.endDate="2012-12-06",a.options=[{value:"$q"},{value:"callback"},{value:"watch"}],a.method=a.options[0],a.$watch(function(){return{symbol:a.symbol,startDate:a.startDate,endDate:a.endDate,method:a.method}},function(c){if(c.symbol&&c.startDate&&c.endDate&&c.method){if(console.log("Start updating "+JSON.stringify(c)),a.items=[],"$q"===a.method.value){var d=b.getHistoricalDataWithQ(a.symbol,a.startDate,a.endDate);d.then(function(b){a.items=b})}"callback"===a.method.value&&b.getHistoricalDataWithCallback(function(b){a.items=b},a.symbol,a.startDate,a.endDate),"watch"===a.method.value&&(a.items=b.getHistoricalDataWithWatch(a.symbol,a.startDate,a.endDate))}},!0)}),financeApp.factory("service",function(a,b){var c=function(a){return encodeURIComponent(a).replace(/[!'()]/g,escape).replace(/\*/g,"%2A").replace(/\"/g,"%22")},d="&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=JSON_CALLBACK";return{getHistoricalDataWithQ:function(e,f,g){var h=a.defer(),i='select * from yahoo.finance.historicaldata where symbol = "'+e+'" and startDate = "'+f+'" and endDate = "'+g+'"',j="http://query.yahooapis.com/v1/public/yql?q="+c(i)+d;return console.log(j),b.jsonp(j).success(function(a){console.log(JSON.stringify(a));var b=a.query.results.quote;console.log(b),h.resolve(b)}).error(function(a){console.log(JSON.stringify(a))}),h.promise},getHistoricalDataWithCallback:function(a,e,f,g){var h='select * from yahoo.finance.historicaldata where symbol = "'+e+'" and startDate = "'+f+'" and endDate = "'+g+'"',i="http://query.yahooapis.com/v1/public/yql?q="+c(h)+d;console.log(i),b.jsonp(i).success(function(b){console.log(JSON.stringify(b));var c=b.query.results.quote;a(c)}).error(function(a){console.log(JSON.stringify(a))})},getHistoricalDataWithWatch:function(a,e,f){var g='select * from yahoo.finance.historicaldata where symbol = "'+a+'" and startDate = "'+e+'" and endDate = "'+f+'"',h="http://query.yahooapis.com/v1/public/yql?q="+c(g)+d;console.log(h);var i={};return b.jsonp(h).success(function(a){console.log(JSON.stringify(a)),i.list=a.query.results.quote}).error(function(a){console.log(JSON.stringify(a))}),i}}});var Markit={};Markit.QuoteService=function(a,b){this.symbol=a,this.fCallback=b,this.DATA_SRC="http://dev.markitondemand.com/Api/v2/Quote/jsonp",this.makeRequest()},Markit.QuoteService.prototype.handleSuccess=function(a){this.fCallback(a)},Markit.QuoteService.prototype.handleError=function(a){console.error(a)},Markit.QuoteService.prototype.makeRequest=function(){this.xhr&&this.xhr.abort(),this.xhr=$.ajax({data:{symbol:this.symbol},url:this.DATA_SRC,dataType:"jsonp",success:this.handleSuccess,error:this.handleError,context:this})},WeatherAppFinal.factory("openweathermap",function(a){var b="279b4be6d54c8bf6ea9b12275a567156",c="http://api.openweathermap.org/data/2.5/";return a(c+":path/:subPath?q=:location",{APPID:b,mode:"json",callback:"JSON_CALLBACK",units:"metric",lang:"en"},{queryWeather:{method:"JSONP",params:{path:"weather"},isArray:!1,headers:{"x-api-key":b}},queryForecast:{method:"JSONP",params:{path:"forecast"},isArray:!1,headers:{"x-api-key":b}},queryForecastDaily:{method:"JSONP",params:{path:"forecast",subPath:"daily",cnt:7},isArray:!1,headers:{"x-api-key":b}}})}),WeatherAppFinal.controller("stateController",function(a,b,c,d){a.message="",a.hasState="",a.exampleLocations=c,a.stormLocations=d,a.forecast=b.queryForecastDaily({location:c[0]}),a.getForecastByLocation=function(){""!=a.location&&"undefined"!=a.location||(a.hasState="has-warning",a.message="please provide a location"),a.hasState="has-Success",a.forecast=b.queryForecastDaily({location:a.location})},a.setLocation=function(b){a.location=b,a.getForecastByLocation()}});var WeatherAppFinal=angular.module("WeatherAppFinal",["ui.router","ngResource","ui.bootstrap","ct.ui.router.extras","ngMessages"]);WeatherAppFinal.config(function(a,b){b.otherwise("/home"),a.state("about",{url:"/about",views:{"":{templateUrl:"partials/state2.html"},"columnOne@about":{templateUrl:"partials/forecast.html",controller:"stateController"},"columnTwo@about":{templateUrl:"partials/deep-state.html",controller:"state2Ctrl"}}})}),WeatherAppFinal.value("version","0.1.6"),WeatherAppFinal.value("exampleLocations",["Hamburg","San Francisco","Berlin","Athens","Tokyo","New York","Moscow","Clonakilty"]),WeatherAppFinal.value("stormLocations",["Sylt","St. Peter-Ording","Husum","Bremerhaven","Hamburg","Kiel","LÃ¼beck"]),WeatherAppFinal.controller("state2Ctrl",function(a,b,c,d){a.movies=d.query()}),WeatherAppFinal.factory("Movie",function(a){return a("http://jsonplaceholder.typicode.com/users/:id",{id:"@id"},{update:{method:"PUT"}})}),WeatherAppFinal.directive("weatherPanel",function(){return{restrict:"AE",scope:{useDayForecast:"=showEntry",forecast:"=weatherPanel"},templateUrl:"partials/_weather-panel-light.html",link:function(a,b,c){a.parseDate=function(a){return new Date(1e3*a)}}}});